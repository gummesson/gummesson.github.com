    <!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1.0">
  <meta name="description" content="Ellen Gummesson – Random ramblings, musings and geekiness">
  <meta name="author" content="Ellen Gummesson">
  <link rel="dns-prefetch" href="//fonts.googleapis.com">
  <link rel="dns-prefetch" href="//cdnjs.cloudflare.com">
  <link rel="dns-prefetch" href="//netdna.bootstrapcdn.com">
  <title>Getting started with gulp – Ellen Gummesson</title>
  <link href="//fonts.googleapis.com/css?family=Open+Sans:400italic,400,700" rel="stylesheet">
  <link rel="stylesheet" href="/assets/css/style.css">
  <link href="//netdna.bootstrapcdn.com/font-awesome/3.2.1/css/font-awesome.css" rel="stylesheet">
  <link rel="shortcut icon" href="/assets/img/favicon.ico">
  <link rel="author" href="/humans.txt" type="text/plain">
  <link rel="canonical" href="http://ellengummesson.com">
  <link rel="alternate" href="/feed.xml" type="application/rss+xml" title="Ellen Gummesson: Random ramblings, musings and geekiness (RSS Feed)">
  <link rel="sitemap" href="/sitemap.xml" type="application/xml" title="Ellen Gummesson: Random ramblings, musings and geekiness (Sitemap)">
  <!--[if lt IE 9]>
     <script src="//cdnjs.cloudflare.com/ajax/libs/html5shiv/3.6.2/html5shiv.js"></script>
  <![endif]-->
</head>
  <body>
    <div class="site-container">

        <nav class="island  site-nav">
      <div id="js-mobile-nav" class="wrapper  wrapper--banner">
        <ul id="js-nav" class="nav  js-nav">
          <li class="print--primary">
            <a class="js-nav--item  link--hidden" href="/" alt="Blog">Home</a>
          </li>
          <li class="print--primary">
            <a class="js-nav--item  link--hidden" href="/about" alt="About">About</a>
          </li>
          <li class="print--primary">
            <a class="js-nav--item  link--hidden" href="/archives" alt="Archives">Archives</a>
          </li>
          <li class="print--primary">
            <a class="js-nav--item  link--hidden" href="/contact" alt="Contact">Contact</a>
          </li>
          <li class="print--primary">
            <a class="link--hidden" href="/feed.xml" alt="Subscribe"><i class="icon-rss"></i></a>
          </li>
        </ul>
      </div>
    </nav><!-- /site-nav -->

        <header class="island  island--banner  site-header">
      <div class="wrapper  wrapper--banner">
        <h1 class="site-logo">
          <a class="link--hidden" href="/" alt="Home">Ellen</a>
        </h1><!-- /site-logo -->
        <p class="print--primary">Random ramblings, musings and geekiness</p>
      </div>
    </header><!-- /site-header -->

      <div class="island  site-content">
        <div class="wrapper">
          <article class="post">
  
    <h1 class="post__title">Getting started with gulp</h1>
  
    <p class="post__meta">
      Posted on January  6, 2014 in <a href="/blog/tag/javascript" alt="JavaScript">JavaScript</a>, <a href="/blog/tag/node.js" alt="Node.js">Node.js</a>, <a href="/blog/tag/gulp" alt="gulp">gulp</a>
    </p>
      <p>During the last couple of weeks there’s been a lot of buzz around <a href="http://gulpjs.com/">gulp</a>, which is a build system similar to <a href="http://gruntjs.com/">Grunt</a> but with a different approach. gulp’s main feature is that it’s using <a href="http://nodejs.org/api/stream.html">streams</a> for all of the processing. This generally means better flow control and thus no need for creating temporary files and folders when you’re running different tasks.</p>

<p>I won’t dwell into how streams work, but if you want to learn more about streams in Node.js work I encourage you to read the “<a href="https://github.com/substack/stream-handbook">Stream handbook</a>”. If you want to learn more about standard streams, try “<a href="http://gigaom.com/2009/07/01/dig-into-unix-standard-streams/">Dig Into Unix: Standard Streams</a>”.</p>

<h2 id="meet-gulp">Meet gulp</h2>

<p><code>gulp</code> is at its core very simple and consists of just a few functions: <code>task</code>, <code>src</code>, <code>dest</code>, <code>run</code>, <code>watch</code> and <code>env</code>. This guide will focus on the first five of those. Take a look at the <a href="https://github.com/gulpjs/gulp/blob/master/README.md#gulp-api">gulp API documentation</a> if you want more information on each individual function.</p>

<p>To define a build task you use <code>gulp.task()</code>:</p>

<pre><code>gulp.task('default', function() {
  // ...
});
</code></pre>

<p>To read your source files you use <code>gulp.src()</code>:</p>

<pre><code>gulp.src('src/app.js')
  .pipe(/* ... */);

gulp.src('src/*.js')
  .pipe(/* ... */);
</code></pre>

<p>To write your files you use <code>gulp.dest()</code>:</p>

<pre><code>.pipe(gulp.dest('dest/app.js'));

.pipe(gulp.dest('dest/'));
</code></pre>

<p>To run different tasks from inside another task you use <code>gulp.run()</code>:</p>

<pre><code>gulp.run('task', 'another-task');
</code></pre>

<p>To watch your files for changes you use <code>gulp.watch()</code>:</p>

<pre><code>gulp.watch('src/*.js', function() {
  // ...
});
</code></pre>

<h2 id="getting-started">Getting started</h2>

<p>To use <code>gulp</code> we first need to install it globally:</p>

<pre><code>npm install gulp -g
</code></pre>

<p>We’ll then add it as a dependency in our project’s <code>package.json</code> file:</p>

<pre><code>npm install gulp --save-dev
</code></pre>

<p>Since we’re going to lint and test our code we’ll also install <code>gulp-jshint</code> and <code>gulp-mocha</code>:</p>

<pre><code>npm install gulp-jshint --save-dev
npm install gulp-mocha --save-dev
</code></pre>

<p>Now let’s create a file called <code>add.js</code> and save it in the a folder called <code>src</code>:</p>

<pre><code>module.exports = function(x, y) {
  return x + y;
};
</code></pre>

<p>We’ll also need some tests. Create a file called <code>add.test.js</code> in a folder called <code>test</code>:</p>

<pre><code>var assert = require('assert');
var add    = require('../src/add.js');

describe('add()', function() {
  it('should return 2 when you pass it 1, 1', function() {
    assert.equal(add(1, 1), 2);
  });
});
</code></pre>

<p>Next we’ll create a file called <code>gulpfile.js</code> at the root of our project and require our dependencies:</p>

<pre><code>var gulp   = require('gulp');
var jshint = require('gulp-jshint');
var mocha  = require('gulp-mocha');
</code></pre>

<p>Then we’ll add our <code>lint</code> and <code>test</code> tasks:</p>

<pre><code>gulp.task('lint', function() {
  return gulp
    .src(['gulpfile.js', 'src/*.js', 'test/*.js'])
    .pipe(jshint())
    .pipe(jshint.reporter('default'));
});

gulp.task('test', function() {
  return gulp
    .src('test/*.js')
    .pipe(mocha());
});
</code></pre>

<p>The reason we use <code>return</code> in our tasks is to make sure that the task finishes completely before the next one gets executed.</p>

<p>Lastly we’ll create our <code>default</code> task. We’ll first add our <code>lint</code> and <code>test</code> tasks as dependencies (since we also want to run them before the <code>default</code> task starts) and then use both <code>gulp.run()</code> and <code>gulp.watch()</code> for running them automatically whenever we update a file:</p>

<pre><code>gulp.task('default', ['lint', 'test'], function() {
  gulp.watch(['src/*.js', 'test/*.js'], function() {
    gulp.run('lint', 'test');
  });
});
</code></pre>

<p>This is how our <code>gulpfile.js</code> looks now:</p>

<pre><code>var gulp   = require('gulp');
var jshint = require('gulp-jshint');
var mocha  = require('gulp-mocha');

gulp.task('lint', function() {
  return gulp
    .src(['gulpfile.js', 'src/*.js', 'test/*.js'])
    .pipe(jshint())
    .pipe(jshint.reporter('default'));
});

gulp.task('test', function() {
  return gulp
    .src('test/*.js')
    .pipe(mocha());
});

gulp.task('default', ['lint', 'test'], function() {
  gulp.watch(['src/*.js', 'test/*.js'], function() {
    gulp.run('lint', 'test');
  });
});
</code></pre>

<p>Now, open up a terminal and run <code>gulp</code>. The output should look similar to this:</p>

<pre><code>[gulp] Using file &lt;PATH&gt;/gulpfile.js
[gulp] Working directory changed to &lt;PATH&gt;
[gulp] Running 'lint'...
[gulp] Running 'test'...
[gulp] Finished 'lint' in 31 ms

  .

  1 passing (2ms)

[gulp] Finished 'test' in 30 ms
[gulp] Running 'default'...
[gulp] Finished 'default' in 5.99 ms
</code></pre>

<p>That’s it. Until you stop the <code>default</code> task both the <code>lint</code> and <code>test</code> tasks will run whenever you modify a file in the <code>src</code> and <code>test</code> folders.</p>

<h2 id="why-use-gulp">Why use gulp?</h2>

<p><a href="http://slid.es/contra/gulp">gulp’s introduction slides</a> brings up a couple of valid reasons for using it in favor of other build systems. You’re writing actual code where you can use Node.js’ standard library in a simple way. All plugins should focus on doing one thing and one thing only, as stated in the guidelines on “<a href="https://github.com/gulpjs/gulp/wiki/Writing-a-gulp-plugin">writing a gulp plugin</a>”.</p>

<p>In the end, like always, it’s just a matter of preference.</p>

</article><!-- /post -->

  <div class="comments">
  <h1>Comments</h1>
  <div id="disqus_thread"></div>
  <script type="text/javascript">
  /* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
    var disqus_shortname = 'ellengummesson'; // required: replace example with your forum shortname
      /* * * DON'T EDIT BELOW THIS LINE * * */
      (function() {
        var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
        dsq.src = 'http://' + disqus_shortname + '.disqus.com/embed.js';
        (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    })();
  </script>
  <noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
  <a href="http://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>
</div><!-- /comments -->



        </div>
      </div><!-- /site-content -->
        <footer class="island  island--banner  site-footer">
      <div class="wrapper  wrapper--banner">
        <p class="print--primary">Copyright &copy; <a class="link--hidden" href="/" alt="Home">Ellen Gummesson</a> 2014</p>
      </div>
    </footer><!-- /site-footer-->
  </div><!-- /site-container -->
  <script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/7.3/highlight.min.js"></script>
  <script src="/assets/js/app.js"></script>
</body>
</html>

